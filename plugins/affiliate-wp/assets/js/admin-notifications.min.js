var affwp_notifications_vars;document.addEventListener("alpine:init",function(){Alpine.store("affwpNotifications",{isPanelOpen:!1,notificationsLoaded:!1,numberActiveNotifications:0,activeNotifications:[],inactiveNotifications:[],isDismissingAll:!1,init:function(){var affwpNotifications=this,notificationCountBubble=document.querySelector("#affwp-notification-button .affwp-number");notificationCountBubble&&notificationCountBubble.classList.remove("affwp-hidden"),document.addEventListener("keydown",function(e){"Escape"===e.key&&affwpNotifications.closePanel()})},openPanel:function(){var affwpNotifications=this,panelHeader=document.getElementById("affwp-notifications-header");affwpNotifications.isPanelOpen=!0,affwpNotifications.notificationsLoaded&&panelHeader?panelHeader.focus():affwpNotifications.apiRequest("/notifications","GET").then(function(data){affwpNotifications.activeNotifications=data.active,affwpNotifications.numberActiveNotifications=affwpNotifications.activeNotifications.length,affwpNotifications.inactiveNotifications=data.dismissed,affwpNotifications.notificationsLoaded=!0,panelHeader&&panelHeader.focus()}).catch(function(error){})},closePanel:function(){var notificationButton;this.isPanelOpen&&(this.isPanelOpen=!1,notificationButton=document.getElementById("affwp-notification-button"))&&notificationButton.focus()},apiRequest:function(endpoint,method){return fetch(affwp_notifications_vars.restBase+endpoint,{method:method,credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":affwp_notifications_vars.restNonce}}).then(function(response){return response.ok?response.text():Promise.reject(response)}).then(function(data){return data?JSON.parse(data):null})},dismiss:function(event,index){var affwpNotifications=this;void 0!==affwpNotifications.activeNotifications[index]&&(event.target.disabled=!0,event=affwpNotifications.activeNotifications[index],affwpNotifications.apiRequest("/notifications/"+event.id,"DELETE").then(function(response){affwpNotifications.activeNotifications.splice(index,1),affwpNotifications.numberActiveNotifications=affwpNotifications.activeNotifications.length}).catch(function(error){}))},dismissAll:function(event){var affwpNotifications=this;!affwpNotifications.isDismissingAll&&affwpNotifications.activeNotifications.length&&(affwpNotifications.isDismissingAll=!0,event&&event.target&&(event.target.disabled=!0),affwpNotifications.apiRequest("/notifications","DELETE").then(function(){affwpNotifications.activeNotifications=[],affwpNotifications.numberActiveNotifications=0}).catch(function(error){window.console&&console.error&&console.error("AffiliateWP notifications: dismiss-all request failed",error)}).finally(function(){affwpNotifications.isDismissingAll=!1,event&&event.target&&(event.target.disabled=!1)}))}})});