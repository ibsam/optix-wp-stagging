function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){var t;if(r)return"string"==typeof r?_arrayLikeToArray(r,a):"Map"===(t="Object"===(t={}.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}document.addEventListener("alpine:init",function(){Alpine.store("modals",{activeModals:[],registry:{},previousFocus:null,init:function(){var _this=this;document.addEventListener("keydown",function(e){var topModal;"Escape"===e.key&&0<_this.activeModals.length&&(topModal=_this.activeModals[_this.activeModals.length-1])&&!1!==topModal.closeOnEscape&&(e.preventDefault(),_this.close(topModal.id))}),this.registerExistingModals()},register:function(id){var config=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.registry[id]={id:id,isOpen:!1,closeOnEscape:!1!==config.closeOnEscape,closeOnBackdrop:!1!==config.closeOnBackdrop}},open:function(id){var _this2=this,data=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},modal=this.registry[id];modal&&(0===this.activeModals.length&&(this.previousFocus=document.activeElement),modal.isOpen=!0,modal.data=data,this.activeModals.push(modal),window.dispatchEvent(new CustomEvent("affwp:modal:open",{detail:{id:id,data:data}})),setTimeout(function(){_this2.focusModal(id)},0))},close:function(id){var nextModal,_this3=this,modal=this.registry[id];modal&&modal.isOpen&&(modal.isOpen=!1,-1<(modal=this.activeModals.findIndex(function(m){return m.id===id}))&&this.activeModals.splice(modal,1),window.dispatchEvent(new CustomEvent("affwp:modal:close",{detail:{id:id}})),0===this.activeModals.length&&this.previousFocus?(this.previousFocus.focus(),this.previousFocus=null):0<this.activeModals.length&&(nextModal=this.activeModals[this.activeModals.length-1],setTimeout(function(){_this3.focusModal(nextModal.id)},0)))},closeAll:function(){var _this4=this;_toConsumableArray(this.activeModals).reverse().forEach(function(modal){_this4.close(modal.id)})},isOpen:function(id){return(null==(id=this.registry[id])?void 0:id.isOpen)||!1},focusModal:function(id){var autofocusElements,id=document.querySelector('[data-modal-id="'.concat(id,'"]'));id&&(0<(autofocusElements=id.querySelectorAll("[autofocus]")).length?autofocusElements[0]:0<(autofocusElements=id.querySelectorAll('button:not([aria-label="Close"]), [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).length?autofocusElements[0]:id.querySelector("button")||(id.setAttribute("tabindex","-1"),id)).focus()},registerExistingModals:function(){var _this5=this;document.querySelectorAll("[data-modal-id]").forEach(function(modal){var id=modal.dataset.modalId,modal=modal.dataset.modalConfig;id&&!_this5.registry[id]&&_this5.register(id,modal?JSON.parse(modal):{})})}}),Alpine.data("affwpModal",function(){var modalId=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return{modalId:modalId,init:function(){modalId&&!Alpine.store("modals").registry[modalId]&&Alpine.store("modals").register(modalId)},get isOpen(){return Alpine.store("modals").isOpen(this.modalId)},open:function(){var data=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Alpine.store("modals").open(this.modalId,data)},close:function(){Alpine.store("modals").close(this.modalId)}}}),Alpine.store("modals").init()}),window.affwpModals={open:function(id){var data=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};"undefined"!=typeof Alpine&&Alpine.store&&Alpine.store("modals").open(id,data)},close:function(id){"undefined"!=typeof Alpine&&Alpine.store&&Alpine.store("modals").close(id)},closeAll:function(){"undefined"!=typeof Alpine&&Alpine.store&&Alpine.store("modals").closeAll()}};